<!-- Hero Start -->
<notifier-container></notifier-container>

<!-- Hero Start -->
<section class="bg-half bg-light d-table w-100" id="home">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-12 text-center">
        <div class="page-next-level">
          <h4 class="title">Blog Listing</h4>
          <div class="page-next">
            <nav aria-label="breadcrumb" class="d-inline-block">
              <ul class="breadcrumb bg-white rounded shadow mb-0">
                <li class="breadcrumb-item">
                  <a href="javascript:void(0)">Blog</a>
                </li>
                <li class="breadcrumb-item active" aria-current="page">
                  Blog List
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </div>
      <!--end col-->
    </div>
    <!--end row-->
  </div>
  <!--end container-->
</section>

<!--end section-->
<div class="position-relative">
  <div class="shape overflow-hidden text-white">
    <svg viewBox="0 0 2880 48" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path
        d="M0 48H1437.5H2880V0H2160C1442.5 52 720 0 720 0H0V48Z"
        fill="currentColor"
      ></path>
    </svg>
  </div>
</div>
<!-- Hero End -->

<!--Blog Lists Start-->
<section class="section">
  <div class="container">
    <div class="d-flex justify-content-end">
      <button
        *ngIf="userService.isAuthenticated()"
        type="button"
        class="btn btn-success mb-2"
        (click)="openModal(modalBasicContent)"
      >
        Add Blog
      </button>
    </div>

    <div class="row">
      <!-- Button to open the Add Publication modal -->
      <!-- <button
        type="button"
        class="btn btn-primary"
        data-toggle="modal"
        data-target="#addPublicationModal"
      >
        Add Publication
      </button> -->

      <!-- Include the "add-publication" component to show the modal content -->
      <!-- <app-add-publication></app-add-publication> -->

      <div class="col-lg-6 col-12 mb-4 pb-2" *ngFor="let data of blogListData">
        <div class="card blog rounded border-0 shadow overflow-hidden">
          <div class="row align-items-center g-0">
            <div class="col-md-6">
              <img
                src="https://www.khov.com/blog/wp-content/uploads/2019/08/Ranch-Style-Home-at-K.-Hovnanians-Four-Seasons-at-Belle-Terre-1600x1024.jpg"
                class="img-fluid"
                alt=""
              />
              <div class="overlay bg-dark"></div>
              <div class="author">
                <!-- <small class="text-light user d-block"
                  ><i class="uil uil-user"></i> {{ data.user.firstname }}
                  {{ data.user.lastName }}</small
                > -->
                <small class="text-light date"
                  ><i class="uil uil-calendar-alt"></i>
                  {{ data.createdAt }}</small
                >
              </div>
            </div>

            <div class="col-md-6">
              <div class="card-body content">
                <h5>
                  <a
                    href="javascript:void(0)"
                    class="card-title title text-dark"
                    >{{ data.title }}</a
                  >
                </h5>
                <p class="text-muted mb-0">{{ data.content }}</p>
                <div class="post-meta d-flex justify-content-between mt-3">
                  <ul class="list-unstyled mb-0">
                    <li class="list-inline-item me-2 mb-0">
                      <a href="javascript:void(0)" class="text-muted like"
                        ><i class="uil uil-heart me-1"></i
                        >{{ data.reactions.length }}</a
                      >
                    </li>
                    <li class="list-inline-item">
                      <a href="javascript:void(0)" class="text-muted comments"
                        ><i class="uil uil-comment me-1"></i
                        >{{ data.comments.length }}</a
                      >
                    </li>
                  </ul>
                  <a
                    [routerLink]="['/blogs', data.id]"
                    class="text-muted readmore"
                    >Read More <i class="uil uil-angle-right-b align-middle"></i
                  ></a>
                </div>

                <div class="mt-3 d-flex justify-content-between">
                  <button
                    class="btn btn-primary btn-card-blog"
                    *ngIf="
                      userService.isAuthenticated() && userId == data?.user?.id
                    "
                    (click)="openUpdateModal(data, updatdeModal)"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="15"
                      height="15"
                      viewBox="0 0 14 14"
                    >
                      <g
                        fill="none"
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      >
                        <path
                          d="m7.5 9l-3 .54L5 6.5L10.73.79a1 1 0 0 1 1.42 0l1.06 1.06a1 1 0 0 1 0 1.42Z"
                        />
                        <path
                          d="M12 9.5v3a1 1 0 0 1-1 1H1.5a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h3"
                        />
                      </g>
                    </svg>
                  </button>
                  <button
                    class="btn btn-danger btn-card-blog"
                    *ngIf="
                      userService.isAuthenticated() && userId == data?.user?.id
                    "
                    (click)="deletePublication(data.id)"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="18"
                      height="18"
                      viewBox="0 0 24 24"
                    >
                      <path
                        fill="currentColor"
                        d="M19 4h-3.5l-1-1h-5l-1 1H5v2h14M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12Z"
                      />
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!--end blog post-->
      </div>
      <!--end col-->
      <!-- PAGINATION START -->
      <div class="col-12">
        <ul class="pagination justify-content-center mb-0">
          <li class="page-item">
            <a class="page-link" href="javascript:void(0)" aria-label="Previous"
              >Prev</a
            >
          </li>
          <li class="page-item active">
            <a class="page-link" href="javascript:void(0)">1</a>
          </li>
          <li class="page-item">
            <a class="page-link" href="javascript:void(0)" aria-label="Next"
              >Next</a
            >
          </li>
        </ul>
      </div>
      <!--end col-->
      <!-- PAGINATION END -->
    </div>
    <!--end row-->
  </div>
  <!--end container-->
</section>
<!--end section -->
<!--Blog Lists End-->

<ng-template #modalBasicContent let-modal="">
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Ajouter un Blog</h4>
    <button
      type="button"
      class="btn-close"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    ></button>
  </div>
  <div class="modal-body">
    <form [formGroup]="publicationForm" (submit)="createPublication()">
      <!-- Form fields for title and content -->
      <div class="form-group">
        <label for="title">Title</label>
        <input
          type="text"
          class="form-control"
          id="title"
          formControlName="title"
          required
        />
      </div>
      <div class="form-group">
        <label for="content">Content</label>
        <textarea
          class="form-control"
          id="content"
          formControlName="content"
          required
        ></textarea>
      </div>
      <!-- Add more fields if needed -->
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" data-dismiss="modal">
      Cancel
    </button>
    <button type="submit" class="btn btn-primary" (click)="createPublication()">
      Create
    </button>
  </div>
</ng-template>

<ng-template #updatdeModal let-modal="">
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Modifier un Blog</h4>
    <button
      type="button"
      class="btn-close"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    ></button>
  </div>
  <div class="modal-body">
    <form [formGroup]="publicationForm" (submit)="updatePublication()">
      <!-- Form fields for title and content -->
      <div class="form-group">
        <label for="title">Title</label>
        <input
          type="text"
          class="form-control"
          id="title"
          formControlName="title"
          required
        />
      </div>
      <div class="form-group">
        <label for="content">Content</label>
        <textarea
          class="form-control"
          id="content"
          formControlName="content"
          required
        ></textarea>
      </div>
      <!-- Add more fields if needed -->
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" data-dismiss="modal">
      Cancel
    </button>
    <button type="submit" class="btn btn-primary" (click)="updatePublication()">
      update
    </button>
  </div>
</ng-template>
